<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Alpha Care Group â€“ Development Roadmap</title>
  <meta name="description" content="Children's Care Home Development Roadmap - Alpha Care Group" />
  <meta name="theme-color" content="#E85A6B" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.webmanifest" />
  <link rel="apple-touch-icon" href="/icons/icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Alpha Care Roadmap" />

  <style>
    /* ================  Design Tokens / Themes  ================ */
    :root {
      --brand: #e85a6b;
      --brand-600: #d14361;
      --bg: #f6f7fb;
      --card: #ffffff;
      --muted: #6b7280;
      --text: #121212;
      --border: #e5e7eb;
      --ring: 0 0 0 4px rgba(232,90,107,.15);
      --radius: 14px;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --shadow-sm: 0 6px 18px rgba(0,0,0,.06);
      --header-grad: linear-gradient(135deg, #e85a6b 0%, #f48b73 100%);
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0b0b0d;
        --card: #141418;
        --text: #f3f4f6;
        --muted: #a1a1aa;
        --border: #23232a;
        --shadow: 0 12px 30px rgba(0,0,0,.45);
        --header-grad: linear-gradient(135deg, #e85a6b 0%, #9d4edd 100%);
      }
    }

    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    /* ================  App Bar  ================ */
    .appbar {
      position: sticky;
      top: 0; z-index: 40;
      background: var(--header-grad);
      color: #fff;
      padding: max(env(safe-area-inset-top), 12px) 16px 14px;
      box-shadow: var(--shadow);
    }
    .appbar .row {
      max-width: 1200px; margin: 0 auto; display: grid; gap: 12px;
      grid-template-columns: 1fr auto;
      align-items: center;
    }
    .brand { display:flex; gap:10px; align-items:center }
    .logo { width: 36px; height: 36px; border-radius: 10px; background:#fff2; display:grid; place-items:center; box-shadow: inset 0 0 0 1px #fff3 }
    .logo svg { width:22px; height:22px; stroke:#fff; fill:none; stroke-width:2.2 }
    .title { font-weight: 700; letter-spacing: .2px }

    .controls { display:flex; gap:10px; align-items:center }
    .search {
      position: relative; width: min(520px, 64vw);
    }
    .search input {
      width: 100%; padding: 12px 40px 12px 40px; border-radius: 999px; border: 1px solid #ffffff33; background:#fff2; color:#fff;
      outline: none;
    }
    .search input::placeholder { color:#fff9 }
    .search svg { position:absolute; left:12px; top:50%; transform:translateY(-50%); stroke:#fff; opacity:.9 }

    .pill {
      background:#fff; color: var(--brand); border:0; padding:10px 14px; border-radius:999px; font-weight:600; cursor:pointer;
      box-shadow: var(--shadow-sm);
    }
    .pill:focus-visible { outline: none; box-shadow: var(--ring) }

    /* ================  Layout  ================ */
    .container { max-width: 1200px; margin: 22px auto; padding: 0 16px 120px }

    .stats {
      display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:14px; margin-bottom: 18px;
    }
    .card { background: var(--card); border:1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); }
    .stat { padding:16px }
    .stat h4 { margin:0 0 6px; font-size: .95rem; color: var(--muted) }
    .stat .big { font-weight: 800; font-size: 1.6rem }

    .progress-bar { background: #e5e7eb33; border-radius: 999px; height: 10px; overflow: hidden }
    .progress-fill { height:100%; width: 0%; background: linear-gradient(90deg, #7c3aed, #22d3ee); transition: width .3s ease }

    .phase { overflow: hidden }
    .phase + .phase { margin-top: 14px }
    .phase-head { display:flex; justify-content:space-between; align-items:center; padding:14px 16px; cursor:pointer }
    .phase-title { font-weight: 700 }
    .phase-sub { color: var(--muted); font-size: .9rem }
    .chev { transition: transform .2s ease }
    .phase[open] .chev { transform: rotate(180deg) }

    .phase-body { padding: 0 16px 14px 16px }

    .workstreams { display:grid; grid-template-columns: repeat(auto-fit, minmax(260px,1fr)); gap: 12px }
    .ws { background: var(--card); border:1px solid var(--border); border-radius: 12px; box-shadow: var(--shadow-sm); overflow:hidden }
    .ws h4 { margin:0; padding: 12px 14px; color: var(--brand); border-bottom:1px solid var(--border); font-size: 1rem; background: linear-gradient(180deg, rgba(232,90,107,.08), transparent) }
    .tasks { padding: 8px 6px }

    .task { display:flex; align-items:flex-start; gap:10px; padding:8px; border-radius: 10px; cursor: pointer }
    .task:hover { background: rgba(148,163,184,.12) }
    .task input { width: 18px; height: 18px; margin-top: 2px; accent-color: var(--brand) }
    .task .text { flex:1; font-size: .95rem; line-height: 1.4 }
    .task.completed { opacity: .75 }
    .task.completed .text { text-decoration: line-through }

    .milestone { background: #fff7ed; color:#7c2d12; border:1px solid #fed7aa; padding: 10px 12px; border-radius: 10px; margin: 12px 0 }
    @media (prefers-color-scheme: dark) { .milestone { background:#2a1f1a; color:#fde68a; border-color:#78350f } }

    /* ================  Bottom Nav (mobile)  ================ */
    .nav { position: fixed; left: 0; right: 0; bottom: 0; z-index: 30; padding: max(env(safe-area-inset-bottom), 10px) 14px; }
    .nav .bar { background: var(--card); border:1px solid var(--border); border-radius: 16px; box-shadow: var(--shadow); display:grid; grid-auto-flow: column; gap: 8px; padding: 8px }
    .nav button { background: transparent; border:0; padding:10px; border-radius: 14px; display:flex; gap:8px; align-items:center; justify-content:center; color: var(--muted); font-weight:600 }
    .nav button.active { color: var(--brand); background: rgba(232,90,107,.12) }
    .nav button:focus-visible { outline:none; box-shadow: var(--ring) }

    .offline-indicator { position: fixed; top: 14px; right: 14px; background: #dc2626; color:#fff; padding: 8px 12px; border-radius: 999px; font-size:.85rem; display:none; z-index:45; box-shadow: var(--shadow) }
    .offline-indicator.show { display:block }

    /* motion */
    .fade { animation: fade .25s ease both }
    @keyframes fade { from { opacity: 0; transform: translateY(4px) } to { opacity:1; transform: translateY(0) } }
  </style>
</head>
<body>
  <header class="appbar">
    <div class="row">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 21C7 16.5 4 13.5 4 10.1 4 7.8 5.9 6 8.2 6c1.1 0 2.1.4 2.8 1.1.7-.7 1.7-1.1 2.8-1.1C16.9 6 19 7.8 19 10.1 19 13.5 16 16.5 12 21z" />
          </svg>
        </div>
        <div>
          <div class="title">Alpha Care Group</div>
          <small style="opacity:.9">Development Roadmap</small>
        </div>
      </div>
      <div class="controls">
        <div class="search" role="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m21 21-3.5-3.5M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke-width="2" stroke-linecap="round" /></svg>
          <input id="search" placeholder="Search tasksâ€¦ (e.g. Ofsted, training)" aria-label="Search tasks" />
        </div>
        <button class="pill" id="exportBtn" title="Download your progress as a file">Export</button>
        <input type="file" id="importFile" accept="application/json" hidden />
        <button class="pill" id="importBtn" title="Load progress from a file">Import</button>
      </div>
    </div>
  </header>

  <div id="offlineIndicator" class="offline-indicator">ðŸ“´ Youâ€™re offline â€“ changes will sync when online</div>

  <main class="container">
    <section class="stats">
      <div class="card stat">
        <h4>Overall Progress</h4>
        <div class="progress-bar" aria-hidden="true"><div id="overallFill" class="progress-fill"></div></div>
        <div class="big" id="overallText">0%</div>
      </div>
      <div class="card stat">
        <h4>Current Phase</h4>
        <div class="big" id="currentPhase">Planning & Approvals</div>
      </div>
      <div class="card stat">
        <h4>Completed Tasks</h4>
        <div class="big" id="completedCount">0</div>
      </div>
    </section>

    <!-- Phases -->
    <section id="phases" class="fade">
      <!-- Template helper will populate from markup below so search works -->

      <!-- Phase 1 -->
      <details class="card phase" open>
        <summary class="phase-head" aria-controls="p1">
          <div>
            <div class="phase-title">Phase 1: Planning & Regulatory Approvals</div>
            <div class="phase-sub">Current Phase â€¢ Est. 3â€“6 months</div>
          </div>
          <div style="display:flex; align-items:center; gap:10px">
            <small id="p1progress" class="phase-sub">0%</small>
            <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
        </summary>
        <div id="p1" class="phase-body">
          <div class="milestone"><strong>ðŸŽ¯ Critical Milestone:</strong> Planning permission granted & all regulatory pre-approvals secured</div>
          <div class="workstreams">
            <div class="ws">
              <h4>Planning Application</h4>
              <div class="tasks">
                <label class="task"><input type="checkbox" checked data-tag="planning"><span class="text">Submit planning application</span></label>
                <label class="task"><input type="checkbox" data-tag="planning objection"><span class="text">Address objection 1 with detailed response</span></label>
                <label class="task"><input type="checkbox" data-tag="planning objection"><span class="text">Address objection 2 with detailed response</span></label>
                <label class="task"><input type="checkbox" data-tag="planning objection"><span class="text">Address objection 3 with detailed response</span></label>
                <label class="task"><input type="checkbox" data-tag="planning objection"><span class="text">Address objection 4 with detailed response</span></label>
                <label class="task"><input type="checkbox" data-tag="planning meeting"><span class="text">Attend planning committee meeting</span></label>
                <label class="task"><input type="checkbox" data-tag="planning decision"><span class="text">Receive planning decision</span></label>
              </div>
            </div>
            <div class="ws">
              <h4>Ofsted Pre-Registration</h4>
              <div class="tasks">
                <label class="task"><input type="checkbox" data-tag="ofsted"><span class="text">Contact Ofsted regional office</span></label>
                <label class="task"><input type="checkbox" data-tag="ofsted meeting"><span class="text">Attend pre-registration meeting</span></label>
                <label class="task"><input type="checkbox" data-tag="ofsted policy"><span class="text">Review residential care requirements</span></label>
                <label class="task"><input type="checkbox" data-tag="ofsted framework"><span class="text">Understand inspection framework</span></label>
              </div>
            </div>
            <div class="ws">
              <h4>Local Authority Engagement</h4>
              <div class="tasks">
                <label class="task"><input type="checkbox" checked data-tag="authority"><span class="text">Identify commissioning authorities</span></label>
                <label class="task"><input type="checkbox" data-tag="authority"><span class="text">Meet with children's services directors</span></label>
                <label class="task"><input type="checkbox" data-tag="authority rates"><span class="text">Understand placement needs & rates</span></label>
                <label class="task"><input type="checkbox" data-tag="authority referrals"><span class="text">Establish referral pathways</span></label>
              </div>
            </div>
            <div class="ws">
              <h4>Financial & Legal Setup</h4>
              <div class="tasks">
                <label class="task"><input type="checkbox" checked data-tag="finance legal"><span class="text">Secure lease agreement</span></label>
                <label class="task"><input type="checkbox" data-tag="finance funding"><span class="text">Arrange development funding</span></label>
                <label class="task"><input type="checkbox" checked data-tag="legal"><span class="text">Incorporate company structure</span></label>
                <label class="task"><input type="checkbox" data-tag="insurance"><span class="text">Arrange comprehensive insurance</span></label>
                <label class="task"><input type="checkbox" data-tag="accounting"><span class="text">Set up accounting systems</span></label>
              </div>
            </div>
          </div>
        </div>
      </details>

      <!-- Phase 2 -->
      <details class="card phase">
        <summary class="phase-head" aria-controls="p2">
          <div>
            <div class="phase-title">Phase 2: Design & Property Preparation</div>
            <div class="phase-sub">Month 4â€“8 â€¢ Property fitâ€‘out & design</div>
          </div>
          <div style="display:flex; align-items:center; gap:10px">
            <small id="p2progress" class="phase-sub">0%</small>
            <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
        </summary>
        <div id="p2" class="phase-body">
          <div class="milestone"><strong>ðŸŽ¯ Critical Milestone:</strong> Property fully compliant with residential care regulations & ready for occupation</div>
          <div class="workstreams">
            <div class="ws"><h4>Architectural Design</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="architect"><span class="text">Engage architect experienced in care homes</span></label>
              <label class="task"><input type="checkbox" data-tag="design ofsted"><span class="text">Design layouts meeting Ofsted requirements</span></label>
              <label class="task"><input type="checkbox" data-tag="design"><span class="text">Ensure DBS-compliant sight lines</span></label>
              <label class="task"><input type="checkbox" data-tag="spaces"><span class="text">Plan therapeutic/quiet spaces</span></label>
              <label class="task"><input type="checkbox" data-tag="building regs"><span class="text">Obtain building regulations approval</span></label>
            </div></div>
            <div class="ws"><h4>Specialist Contractors</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="contractor"><span class="text">Select main contractor</span></label>
              <label class="task"><input type="checkbox" data-tag="fire"><span class="text">Install fire safety systems</span></label>
              <label class="task"><input type="checkbox" data-tag="cctv"><span class="text">CCTV system installation</span></label>
              <label class="task"><input type="checkbox" data-tag="security"><span class="text">Secure door/window systems</span></label>
              <label class="task"><input type="checkbox" data-tag="kitchen"><span class="text">Kitchen fitâ€‘out for commercial use</span></label>
            </div></div>
            <div class="ws"><h4>Health & Safety</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="gas"><span class="text">Gas safety certificates</span></label>
              <label class="task"><input type="checkbox" data-tag="electrical"><span class="text">Electrical safety inspection</span></label>
              <label class="task"><input type="checkbox" data-tag="legionella"><span class="text">Legionella risk assessment</span></label>
              <label class="task"><input type="checkbox" data-tag="asbestos"><span class="text">Asbestos survey (if preâ€‘2000 building)</span></label>
              <label class="task"><input type="checkbox" data-tag="fire"><span class="text">Fire risk assessment</span></label>
            </div></div>
            <div class="ws"><h4>Furniture & Equipment</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="furniture"><span class="text">Source childâ€‘safe furniture</span></label>
              <label class="task"><input type="checkbox" data-tag="it"><span class="text">Install office systems & IT</span></label>
              <label class="task"><input type="checkbox" data-tag="first aid"><span class="text">First aid & medical equipment</span></label>
              <label class="task"><input type="checkbox" data-tag="recreation"><span class="text">Recreational equipment</span></label>
            </div></div>
          </div>
        </div>
      </details>

      <!-- Phase 3 -->
      <details class="card phase">
        <summary class="phase-head" aria-controls="p3">
          <div>
            <div class="phase-title">Phase 3: Policy Development & Systems</div>
            <div class="phase-sub">Month 6â€“10 â€¢ Parallel with Phase 2</div>
          </div>
          <div style="display:flex; align-items:center; gap:10px">
            <small id="p3progress" class="phase-sub">0%</small>
            <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
        </summary>
        <div id="p3" class="phase-body">
          <div class="milestone"><strong>ðŸŽ¯ Critical Milestone:</strong> All policies, procedures & systems ready for Ofsted registration</div>
          <div class="workstreams">
            <div class="ws"><h4>Safeguarding Framework</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="policy"><span class="text">Child protection policy</span></label>
              <label class="task"><input type="checkbox" data-tag="policy"><span class="text">Behaviour management policy</span></label>
              <label class="task"><input type="checkbox" data-tag="policy"><span class="text">Physical intervention policy</span></label>
              <label class="task"><input type="checkbox" data-tag="policy"><span class="text">Missing child procedures</span></label>
              <label class="task"><input type="checkbox" data-tag="policy"><span class="text">Complaints procedure</span></label>
            </div></div>
            <div class="ws"><h4>Care Planning Systems</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="care"><span class="text">Care planning policy</span></label>
              <label class="task"><input type="checkbox" data-tag="care"><span class="text">Key worker system</span></label>
              <label class="task"><input type="checkbox" data-tag="education"><span class="text">Education support framework</span></label>
              <label class="task"><input type="checkbox" data-tag="health"><span class="text">Health care procedures</span></label>
              <label class="task"><input type="checkbox" data-tag="family"><span class="text">Contact with families policy</span></label>
            </div></div>
            <div class="ws"><h4>Record Keeping & IT</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="software"><span class="text">Select care management software</span></label>
              <label class="task"><input type="checkbox" data-tag="records"><span class="text">Set up secure record systems</span></label>
              <label class="task"><input type="checkbox" data-tag="gdpr"><span class="text">Data protection procedures</span></label>
              <label class="task"><input type="checkbox" data-tag="logging"><span class="text">Daily logging systems</span></label>
              <label class="task"><input type="checkbox" data-tag="finance"><span class="text">Financial management systems</span></label>
            </div></div>
            <div class="ws"><h4>Quality Assurance</h4><div class="tasks">
              <label class="task"><input type="checkbox" data-tag="qa"><span class="text">Quality assurance framework</span></label>
              <label class="task"><input type="checkbox" data-tag="qa"><span class="text">Internal monitoring systems</span></label>
              <label class="task"><input type="checkbox" data-tag="qa"><span class="text">Staff supervision framework</span></label>
              <label class="task"><input type="checkbox" data-tag="qa"><span class="text">Independent visitor arrangements</span></label>
            </div></div>
          </div>
        </div>
      </details>

      <!-- Phase 4 -->
      <details class="card phase">
        <summary class="phase-head" aria-controls="p4">
          <div>
            <div class="phase-title">Phase 4: Staffing & Training</div>
            <div class="phase-sub">Month 8â€“12 â€¢ Critical for registration</div>
          </div>
          <div style="display:flex; align-items:center; gap:10px">
            <small id="p4progress" class="phase-sub">0%</small>
            <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
        </summary>
        <div id="p4" class="phase-body">
          <div class="milestone"><strong>ðŸŽ¯ Critical Milestone:</strong> Full staff team recruited, DBS checked & trained ready for opening</div>
          <div class="workstreams">
            <div class="ws"><h4>Senior Staff Recruitment</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Recruit Registered Manager</span></label>
              <label class="task"><input type="checkbox"><span class="text">Recruit Deputy Manager</span></label>
              <label class="task"><input type="checkbox"><span class="text">Recruit Senior Care Workers</span></label>
              <label class="task"><input type="checkbox"><span class="text">Complete enhanced DBS checks</span></label>
            </div></div>
            <div class="ws"><h4>Care Staff Team</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Recruit residential care workers</span></label>
              <label class="task"><input type="checkbox"><span class="text">Recruit waking night staff</span></label>
              <label class="task"><input type="checkbox"><span class="text">Create shift patterns & rotas</span></label>
              <label class="task"><input type="checkbox"><span class="text">Complete all employment checks</span></label>
            </div></div>
            <div class="ws"><h4>Specialist Staff</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Education coordinator</span></label>
              <label class="task"><input type="checkbox"><span class="text">Therapeutic support worker</span></label>
              <label class="task"><input type="checkbox"><span class="text">Administrative support</span></label>
              <label class="task"><input type="checkbox"><span class="text">Maintenance/domestic staff</span></label>
            </div></div>
            <div class="ws"><h4>Training Programme</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Safeguarding training</span></label>
              <label class="task"><input type="checkbox"><span class="text">Behaviour management training</span></label>
              <label class="task"><input type="checkbox"><span class="text">First aid & medication training</span></label>
              <label class="task"><input type="checkbox"><span class="text">Fire safety training</span></label>
              <label class="task"><input type="checkbox"><span class="text">System & policy training</span></label>
            </div></div>
          </div>
        </div>
      </details>

      <!-- Phase 5 -->
      <details class="card phase">
        <summary class="phase-head" aria-controls="p5">
          <div>
            <div class="phase-title">Phase 5: Registration & Operational Launch</div>
            <div class="phase-sub">Month 12â€“15 â€¢ Go live phase</div>
          </div>
          <div style="display:flex; align-items:center; gap:10px">
            <small id="p5progress" class="phase-sub">0%</small>
            <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
        </summary>
        <div id="p5" class="phase-body">
          <div class="milestone"><strong>ðŸŽ¯ Critical Milestone:</strong> Ofsted registration granted & first placements secured</div>
          <div class="workstreams">
            <div class="ws"><h4>Ofsted Registration</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Submit full registration application</span></label>
              <label class="task"><input type="checkbox"><span class="text">Prepare for inspection visit</span></label>
              <label class="task"><input type="checkbox"><span class="text">Attend Ofsted inspection</span></label>
              <label class="task"><input type="checkbox"><span class="text">Address any conditions</span></label>
              <label class="task"><input type="checkbox"><span class="text">Receive registration certificate</span></label>
            </div></div>
            <div class="ws"><h4>Operational Readiness</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Final staff training & team building</span></label>
              <label class="task"><input type="checkbox"><span class="text">Test all systems & procedures</span></label>
              <label class="task"><input type="checkbox"><span class="text">Emergency procedure drills</span></label>
              <label class="task"><input type="checkbox"><span class="text">Soft opening with staff</span></label>
            </div></div>
            <div class="ws"><h4>First Placements</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Confirm placement agreements</span></label>
              <label class="task"><input type="checkbox"><span class="text">Prepare admission packs</span></label>
              <label class="task"><input type="checkbox"><span class="text">Conduct transition planning</span></label>
              <label class="task"><input type="checkbox"><span class="text">Welcome first residents</span></label>
            </div></div>
            <div class="ws"><h4>Quality Monitoring</h4><div class="tasks">
              <label class="task"><input type="checkbox"><span class="text">Implement daily monitoring</span></label>
              <label class="task"><input type="checkbox"><span class="text">Weekly management reviews</span></label>
              <label class="task"><input type="checkbox"><span class="text">Monthly quality reports</span></label>
              <label class="task"><input type="checkbox"><span class="text">Prepare for 6â€‘month inspection</span></label>
            </div></div>
          </div>
        </div>
      </details>
    </section>
  </main>

  <nav class="nav">
    <div class="bar">
      <button class="active" aria-label="Home">Home</button>
      <button aria-label="Tasks">Tasks</button>
      <button id="importNav" aria-label="Settings">Settings</button>
    </div>
  </nav>

  <!-- iOS Add-to-Home-Screen helper (only shows when not installed) -->
  <div id="iosTip" class="card fade" style="position:fixed; left:12px; right:12px; bottom:84px; padding:12px; display:none">
    ðŸ“± <strong>Add to Home Screen:</strong> In Safari, tap <em>Share</em> â†’ <strong>Add to Home Screen</strong>.
  </div>

  <script>
    // ====== Utilities / State ======
    const STORAGE_KEY = 'alphacare_progress_v2';
    const PHASE_KEYS = ['p1','p2','p3','p4','p5'];

    function getAllCheckboxes() { return Array.from(document.querySelectorAll('.tasks input[type="checkbox"]')) }

    function saveProgress() {
      const checks = getAllCheckboxes().map(cb => cb.checked);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(checks));
    }

    function loadProgress() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return;
      try {
        const arr = JSON.parse(raw);
        getAllCheckboxes().forEach((cb, i) => {
          if (arr[i]) cb.checked = true;
          cb.closest('.task').classList.toggle('completed', cb.checked);
        });
      } catch(e) { console.warn('Progress load failed', e) }
    }

    function updateProgressUI() {
      const boxes = getAllCheckboxes();
      const done = boxes.filter(b => b.checked).length;
      const pct = Math.round((done / boxes.length) * 100) || 0;
      document.getElementById('overallFill').style.width = pct + '%';
      document.getElementById('overallText').textContent = pct + '%';
      document.getElementById('completedCount').textContent = done;

      // Phase bars
      PHASE_KEYS.forEach((key, idx) => {
        const body = document.getElementById(key);
        if (!body) return;
        const cbs = body.querySelectorAll('input[type="checkbox"]');
        const d = body.querySelectorAll('input[type="checkbox"]:checked');
        const p = cbs.length ? Math.round((d.length / cbs.length) * 100) : 0;
        const label = document.getElementById(key + 'progress');
        if (label) label.textContent = p + '%';
      });

      // Current phase (first <details> that is open)
      const open = Array.from(document.querySelectorAll('.phase[open]'))[0];
      if (open) {
        const name = open.querySelector('.phase-title')?.textContent || 'Phases';
        document.getElementById('currentPhase').textContent = name.replace('Phase ','Phase ');
      }
    }

    // ====== Interactions ======
    document.addEventListener('change', (e) => {
      if (e.target.matches('.tasks input[type="checkbox"]')) {
        e.target.closest('.task').classList.toggle('completed', e.target.checked);
        saveProgress();
        updateProgressUI();
      }
    });

    // Search / filter
    const search = document.getElementById('search');
    search.addEventListener('input', () => {
      const q = search.value.trim().toLowerCase();
      const tasks = document.querySelectorAll('.task');
      tasks.forEach(t => {
        const text = t.textContent.toLowerCase();
        const tags = t.querySelector('input')?.dataset.tag || '';
        const hit = text.includes(q) || tags.toLowerCase().includes(q);
        t.style.display = hit ? '' : 'none';
      });
    });

    // Export / Import
    document.getElementById('exportBtn').addEventListener('click', () => {
      const data = localStorage.getItem(STORAGE_KEY) || '[]';
      const blob = new Blob([data], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'alpha-care-progress.json';
      a.click();
      URL.revokeObjectURL(a.href);
    });

    const importFile = document.getElementById('importFile');
    document.getElementById('importBtn').addEventListener('click', () => importFile.click());
    document.getElementById('importNav').addEventListener('click', () => importFile.click());
    importFile.addEventListener('change', async () => {
      const file = importFile.files[0];
      if (!file) return;
      const text = await file.text();
      try {
        JSON.parse(text); // quick check
        localStorage.setItem(STORAGE_KEY, text);
        loadProgress();
        updateProgressUI();
      } catch (e) { alert('Invalid file'); }
      importFile.value = '';
    });

    // Online/offline indicator
    const offline = document.getElementById('offlineIndicator');
    window.addEventListener('online', () => offline.classList.remove('show'));
    window.addEventListener('offline', () => offline.classList.add('show'));

    // iOS Add to Home Screen hint (only if not installed)
    const iosTip = document.getElementById('iosTip');
    const isIos = /iphone|ipad|ipod/i.test(navigator.userAgent);
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
    if (isIos && !isStandalone) iosTip.style.display = 'block';

    // Init
    loadProgress();
    updateProgressUI();
  </script>

  <!-- SW registration (kept external in your project) -->
  <script src="/register-sw.js"></script>
</body>
</html>
